import{r as j,j as e}from"./app-c379ad01.js";import A from"./DropdownButton-0d222530.js";import{t as b}from"./toastr-87efd738.js";import"./_commonjsHelpers-de833af9.js";function w(t){const n=new Date(t);if(!Number.isNaN(n.valueOf()))return n;const r=String(t).match(/\d+/g);if(r==null||r.length<=2)return n;{const[a,l,...c]=r.map(u=>parseInt(u)),m=[a,l-1,...c];return new Date(Date.UTC(...m))}}function D(t,n,r){const a=t!==1?n+"s":n;return t+" "+a+" "+r}function S(){return S=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},S.apply(this,arguments)}const g=60,p=g*60,h=p*24,v=h*7,E=h*30,I=h*365,K=()=>Date.now();function H({date:t,formatter:n=D,component:r="time",live:a=!0,minPeriod:l=0,maxPeriod:c=v,title:m,now:i=K,...u}){const[f,k]=j.useState(i());j.useEffect(()=>{if(!a)return;const T=(()=>{const C=w(t).valueOf();if(!C)return console.warn("[react-timeago] Invalid Date provided"),0;const M=Math.round(Math.abs(f-C)/1e3),R=M<g?1e3:M<p?1e3*g:M<h?1e3*p:1e3*v,O=Math.min(Math.max(R,l*1e3),c*1e3);return O?setTimeout(()=>{k(i())},O):0})();return()=>{T&&clearTimeout(T)}},[t,a,c,l,i,f]);const N=r,d=w(t).valueOf();if(!d)return null;const s=Math.round(Math.abs(f-d)/1e3),o=d<f?"ago":"from now",[x,y]=s<g?[Math.round(s),"second"]:s<p?[Math.round(s/g),"minute"]:s<h?[Math.round(s/p),"hour"]:s<v?[Math.round(s/h),"day"]:s<E?[Math.round(s/v),"week"]:s<I?[Math.round(s/E),"month"]:[Math.round(s/I),"year"],_=typeof m>"u"?typeof t=="string"?t:w(t).toISOString().substr(0,16).replace("T"," "):m,F=N==="time"?{...u,dateTime:w(t).toISOString()}:u,U=D.bind(null,x,y,o);return j.createElement(N,S({},F,{title:_}),n(x,y,o,d,U,i))}function q({user:t,categoryPost:n,postComments:r}){var d;const[a,l]=j.useState(r),[c,m]=j.useState(""),i=(d=document.querySelector('meta[name="csrf-token"]'))==null?void 0:d.content,u=async()=>{if(c.length!==0)try{if(!(await fetch(route("web.category.post.comment.store",n.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":i},body:JSON.stringify({postId:n.id,comment:c})})).ok)throw new Error("Failed to submit comment");const o={id:a.length+1,author:{name:t.name,img:t.img},content:c,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("New comment:",o),l([...a,o]),m("")}catch(s){console.error("Error submitting comment:",s)}},f=[{label:"Delete Comment",iconClass:"fa-regular fa-trash-can",action:({commentId:s})=>k(s)},{label:"Mute User",iconClass:"fa-solid fa-volume-xmark",action:({userId:s})=>N(s)}];async function k(s){const o=await fetch(route("web.category.post.comment.delete",s),{method:"DELETE",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":i}}),x=await o.json();o.ok?(l(a.filter(y=>y.id!==s)),b.success(x.message)):b.error(x.message)}async function N(s){(await fetch(route("admin.user.mute",s))).ok?b.success("User muted successfully"):b.error("Failed to mute user")}return e.jsx("div",{className:"min-h-[calc(100vh-6rem)] bg-gray-200",children:e.jsx("div",{className:"justify-center py-10 mx-auto sm:container sm:p-10",children:e.jsxs("div",{className:"block max-w-4xl mx-auto bg-white rounded-lg shadow-secondary-1 dark:bg-surface-dark dark:text-white text-surface",children:[e.jsxs("div",{className:"p-6",children:[e.jsx("h5",{className:"mb-2 text-2xl font-semibold leading-tight",children:n.title}),e.jsxs("div",{className:"flex gap-2 m-1 text-gray-500",children:[e.jsxs("small",{className:"flex items-center gap-1",children:[e.jsx("span",{children:e.jsx("i",{className:"text-gray-400 fa-solid fa-eye"})}),e.jsx("span",{children:n.views})]}),e.jsxs("small",{className:"flex items-center gap-1",children:[e.jsx("span",{children:e.jsx("i",{className:"text-gray-400 fa-solid fa-clock"})}),e.jsx("span",{children:n.formated_created_at})]})]}),e.jsx("div",{className:"my-5",dangerouslySetInnerHTML:{__html:n.body}})]}),e.jsxs("div",{className:"px-6 py-3 border-t-2 border-gray-200 dark:border-white/10 text-surface/75 dark:text-neutral-300",children:[e.jsx("div",{className:"flex flex-col gap-3",children:a.map((s,o)=>e.jsx(L,{comment:s,options:f,user:t},s.id))}),!t.isMuted&&e.jsxs("div",{className:"flex items-center gap-4 my-3",children:[e.jsx("div",{className:"flex-grow-0 flex-shrink-0 w-12 h-12 rounded-full",children:e.jsx("img",{className:"rounded-full",src:`/images/user_avatar/${t.img}`,alt:""})}),e.jsx("input",{className:"w-11/12 bg-gray-100 rounded-full",type:"text",placeholder:"Write something...",value:c,onChange:s=>m(s.target.value)}),e.jsx("button",{className:"p-2 rounded-full bg-primary",onClick:u,children:e.jsx("span",{children:e.jsx("i",{className:"font-bold text-white fa-2x fa-regular fa-paper-plane"})})})]})]})]})})})}function L(t){return e.jsxs("div",{className:"flex items-center gap-2 my-2",children:[e.jsx("div",{className:"flex-grow-0 flex-shrink-0 w-12 h-12",children:e.jsx("img",{className:"rounded-full",src:`/images/user_avatar/${t.comment.author.img}`,alt:""})}),e.jsxs("div",{className:"flex flex-col p-4 bg-gray-100 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:t.comment.author.name}),e.jsx("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400",children:e.jsx(H,{date:t.comment.created_at})}),t.user.isAdmin&&e.jsx(A,{options:t.options,commentId:t.comment.id,userId:t.comment.author.id})]}),e.jsx("p",{className:"w-full",children:t.comment.content})]})]})}export{q as default};
