document.addEventListener("DOMContentLoaded",function(){document.addEventListener("click",d);var n,l;function d(e){n=e.target.closest("[data-delete-route]"),n&&(e.preventDefault(),l=n.dataset.deleteRoute)}document.getElementById("confirmDeleteBtn").addEventListener("click",()=>{c()});function c(){fetch(l).then(e=>e.json()).then(e=>{e.error==!0?toastr.error(e.message,"Admin Panel"):toastr.success(e.message,"Admin Panel")}),n.parentElement.parentElement.parentElement.remove()}document.addEventListener("click",function(e){const t=e.target.closest("[data-row-data]");if(!t)return;e.preventDefault();const a=t.dataset.updateRoute,r=JSON.parse(t.dataset.rowData);document.getElementById("updateDataForm").setAttribute("action",a),Array.from(document.querySelectorAll(".updateDataField")).forEach((o,i)=>{o.value=r[i]})}),$("form").submit(function(e){$("#loading").toggleClass("d-none"),$("body").css("overflow","hidden"),e.preventDefault();const t=$(this),a=t.attr("action"),r=t.attr("method"),s=new FormData(this);$.ajax({url:a,type:r,data:s,contentType:!1,processData:!1,success:function(o){$("#loading").toggleClass("d-none"),$("body").css("overflow","auto"),o.error==!0?toastr.error(o.message,"Admin Panel"):(toastr.success(o.message,"Admin Panel"),t.parents(".modal").length>0&&t[0].reset(),$(".modal").modal("hide"),$(".dataTable").DataTable().draw())},error:function(o){$("#loading").toggleClass("d-none"),$("body").css("overflow","auto"),console.error("Error:",o)}})}),$(".modal").on("hidden.coreui.modal",function(){$(this).find("form").trigger("reset")}),$("[data-table-route]").each(function(e){const a=$(this).attr("data-table-route"),r=$(this).find("th").map(function(s,o){return{data:$(this).text()==="#"?"serial":$(this).text()==="Category"?"category.title":$(this).text()==="Categories"?"categories_names":$(this).text().toLowerCase(),name:$(this).text(),searchable:$(this).text()!=="#"&&$(this).text()!=="Actions",orderable:$(this).text()!=="Actions",defaultContent:"NA"}});$("[data-table-route]").DataTable({language:{zeroRecords:"No record(s) found."},processing:!0,serverSide:!0,lengthChange:!0,order:[0,"asc"],searchable:!0,bStateSave:!1,ajax:{url:a,data:function(s){}},columns:r})}),$(document).on("click","[data-password-reset-route]",function(e){const t=$(this).data("password-reset-route");fetch(t).then(a=>a.json()).then(a=>{a.error==!0?toastr.error(a.message,"Admin Panel"):toastr.success(a.message,"Admin Panel")})})});
