import{r as g,j as e}from"./app-512d2543.js";import"./_commonjsHelpers-de833af9.js";function N(t){const n=new Date(t);if(!Number.isNaN(n.valueOf()))return n;const a=String(t).match(/\d+/g);if(a==null||a.length<=2)return n;{const[s,d,...c]=a.map(o=>parseInt(o)),l=[s,d-1,...c];return new Date(Date.UTC(...l))}}function C(t,n,a){const s=t!==1?n+"s":n;return t+" "+s+" "+a}function w(){return w=Object.assign?Object.assign.bind():function(t){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(t[s]=a[s])}return t},w.apply(this,arguments)}const f=60,h=f*60,u=h*24,b=u*7,D=u*30,E=u*365,A=()=>Date.now();function H({date:t,formatter:n=C,component:a="time",live:s=!0,minPeriod:d=0,maxPeriod:c=b,title:l,now:m=A,...o}){const[i,p]=g.useState(m());g.useEffect(()=>{if(!s)return;const M=(()=>{const O=N(t).valueOf();if(!O)return console.warn("[react-timeago] Invalid Date provided"),0;const y=Math.round(Math.abs(i-O)/1e3),R=y<f?1e3:y<h?1e3*f:y<u?1e3*h:1e3*b,T=Math.min(Math.max(R,d*1e3),c*1e3);return T?setTimeout(()=>{p(m())},T):0})();return()=>{M&&clearTimeout(M)}},[t,s,c,d,m,i]);const x=a,j=N(t).valueOf();if(!j)return null;const r=Math.round(Math.abs(i-j)/1e3),v=j<i?"ago":"from now",[S,k]=r<f?[Math.round(r),"second"]:r<h?[Math.round(r/f),"minute"]:r<u?[Math.round(r/h),"hour"]:r<b?[Math.round(r/u),"day"]:r<D?[Math.round(r/b),"week"]:r<E?[Math.round(r/D),"month"]:[Math.round(r/E),"year"],I=typeof l>"u"?typeof t=="string"?t:N(t).toISOString().substr(0,16).replace("T"," "):l,_=x==="time"?{...o,dateTime:N(t).toISOString()}:o,F=C.bind(null,S,k,v);return g.createElement(x,w({},_,{title:I}),n(S,k,v,j,F,m))}function K(t){return e.jsxs("div",{className:"flex items-center gap-2 my-2",children:[e.jsx("div",{className:"flex-grow-0 flex-shrink-0 w-12 h-12",children:e.jsx("img",{className:"rounded-full",src:`/images/user_avatar/${t.comment.author.img}`,alt:""})}),e.jsxs("div",{className:"flex flex-col p-4 bg-gray-100 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:t.comment.author.name}),e.jsx("span",{className:"text-sm font-normal text-gray-500 dark:text-gray-400",children:e.jsx(H,{date:t.comment.created_at})})]}),e.jsx("p",{className:"w-full",children:t.comment.content})]})]})}const Y=({user:t,categoryPost:n,postComments:a})=>{const[s,d]=g.useState(a),[c,l]=g.useState(""),m=async()=>{var i;if(c.length===0)return;const o=(i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.content;if(!o){console.error("CSRF token not found");return}try{if(!(await fetch(route("web.category.post.comment.store",n.id),{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":o},body:JSON.stringify({postId:n.id,comment:c})})).ok)throw new Error("Failed to submit comment");const x={id:s.length+1,author:{name:t.name,img:t.img},content:c,created_at:new Date().toISOString(),updated_at:new Date().toISOString()};console.log("New comment:",x),d([...s,x]),l("")}catch(p){console.error("Error submitting comment:",p)}};return e.jsx("div",{className:"min-h-[calc(100vh-6rem)] bg-gray-200",children:e.jsx("div",{className:"justify-center py-10 mx-auto sm:container sm:p-10",children:e.jsxs("div",{className:"block max-w-4xl mx-auto bg-white rounded-lg shadow-secondary-1 dark:bg-surface-dark dark:text-white text-surface",children:[e.jsxs("div",{className:"p-6",children:[e.jsx("h5",{className:"mb-2 text-2xl font-semibold leading-tight",children:n.title}),e.jsxs("div",{className:"flex gap-2 m-1 text-gray-500",children:[e.jsxs("small",{className:"flex items-center gap-1",children:[e.jsx("span",{children:e.jsx("i",{className:"text-gray-400 fa-solid fa-eye"})}),e.jsx("span",{children:n.views})]}),e.jsxs("small",{className:"flex items-center gap-1",children:[e.jsx("span",{children:e.jsx("i",{className:"text-gray-400 fa-solid fa-clock"})}),e.jsx("span",{children:n.formated_created_at})]})]}),e.jsx("div",{className:"my-5",dangerouslySetInnerHTML:{__html:n.body}})]}),e.jsxs("div",{className:"px-6 py-3 border-t-2 border-gray-200 dark:border-white/10 text-surface/75 dark:text-neutral-300",children:[e.jsx("div",{className:"flex flex-col gap-3",children:s.map((o,i)=>e.jsx(K,{comment:o},o.id))}),e.jsxs("div",{className:"flex items-center gap-4 my-3",children:[e.jsx("div",{className:"flex-grow-0 flex-shrink-0 w-12 h-12 rounded-full",children:e.jsx("img",{className:"rounded-full",src:`/images/user_avatar/${t.img}`,alt:""})}),e.jsx("input",{className:"w-11/12 bg-gray-100 rounded-full",type:"text",placeholder:"Write something...",value:c,onChange:o=>l(o.target.value)}),e.jsx("button",{className:"p-2 rounded-full bg-primary",onClick:m,children:e.jsx("span",{children:e.jsx("i",{className:"font-bold text-white fa-2x fa-regular fa-paper-plane"})})})]})]})]})})})};export{Y as default};
