import{$ as o}from"./jquery-b1664d58.js";document.addEventListener("DOMContentLoaded",function(){var t=o.noConflict();t(document).on("submit","#create-post-modal form",function(a){a.preventDefault();var e=t(this),r=e.attr("action");e.attr("method");var s=e.find('button[type="submit"]');s.html('<i class="fas fa-2x fa-sync-alt fa-spin"></i>');var l=new FormData(this);t.ajax({url:r,type:"POST",data:l,processData:!1,contentType:!1,success:function(n){if(s.html("Save changes"),t("#create-post-modal form")[0].reset(),n.error==!0)return Swal.fire({title:"Error!",text:n.data.message,icon:"error",showConfirmButton:!0}).then(i=>{}),console.error("Error saving post:",error.responseText),!1;t("#post-list").html(n.data.posts),console.log("slksssssssssssss",n),Swal.fire({title:"Success!",text:n.data.message,icon:"success",showConfirmButton:!0}).then(i=>{})},error:function(n){s.html("Save changes");const i=n.responseJSON.message;if(console.error("Error:",i),i=="Unauthenticated.")return t("#create-new-group").hide(),Swal.fire({title:"Error!",text:"Please login to create group",icon:"error",showConfirmButton:!0}).then(u=>{}),!1}})}),t(document).on("click",".create-comment-btn",function(a){var e=t(this).data("post_id");t("#hidden_post_id").val(e)}),t(document).on("submit","#comment-form",function(a){a.preventDefault();var e=t(this),r=e.attr("action");e.attr("method");var s=e.find('button[type="submit"]');s.html('<i class="fas fa-2x fa-sync-alt fa-spin"></i>');var l=new FormData(this);t.ajax({url:r,type:"POST",data:l,processData:!1,contentType:!1,success:function(n){if(s.html("Save changes"),t("#comment-form")[0].reset(),n.error==!0)return Swal.fire({title:"Error!",text:n.data.message,icon:"error",showConfirmButton:!0}).then(u=>{}),console.error("Error saving post:",error.responseText),!1;var i=l.get("post_id");t("#comment_count_"+i).html(n.data.comment_count),Swal.fire({title:"Success!",text:n.data.message,icon:"success",showConfirmButton:!0}).then(u=>{}),t("#create-post-modal").addClass("hidden")},error:function(n){s.html("Save changes");const i=n.responseJSON.message;if(console.error("Error:",i),i=="Unauthenticated.")return t("#create-new-group").hide(),Swal.fire({title:"Error!",text:"Please login to create group",icon:"error",showConfirmButton:!0}).then(u=>{}),!1}})}),t(document).on("click",".comment-list",function(a){const e=t(this).data("comments-route");t("#popup-comment-list").html('<span class="text-center">Loading...</span>'),t.ajax({url:e,type:"GET",data:{post_id:t(this).data("post_id")},success:function(r){if(r.error==!0)return Swal.fire({title:"Error!",text:r.data.message,icon:"error",showConfirmButton:!0}).then(s=>{}),console.error("Error saving post:",error.responseText),!1;t("#popup-comment-list").html(r.data.comments)},error:function(r){console.error("Error:",r.message)}})}),t(document).on("click",".like-post",function(a){const e=t(this);t.ajax({url:o(this).data("route"),type:"POST",data:{post_id:o(this).data("post_id")},headers:{"X-CSRF-TOKEN":o('meta[name="csrf-token"]').attr("content")},success:function(r){if(r.error==!0)return Swal.fire({title:"Error!",text:r.data.message,icon:"error",showConfirmButton:!0}).then(l=>{}),console.error("Error saving post:",error.responseText),!1;var s=r.data.post_id;t("#like_count_"+s).html(r.data.like_count),e.html(r.data.button)},error:function(r){console.error("Error:",errorMessage)}})}),t(document).on("click",".view-all-replies",function(a){a.preventDefault();var e=t(this).data("comment_id");t("#comment"+e+" .additional-replies").css("display","flex"),t(this).hide()}),t(document).on("click",".edit-button",function(a){var e=o(this).siblings("div").find("p").text();console.log("llllllllllllllll",o(this).data("url")),o(this).siblings("div").find("p").replaceWith('<input type="text" class="edit-field" value="'+e+'">'),o(this).siblings("div").find("input").focus(),o(this).siblings("div").find("input").get(0).setSelectionRange(e.length,e.length),o(this).html('<i class="fa-solid fa-save"></i>').addClass("save-button").removeClass("edit-button")}),t(document).on("click",".save-button",function(){o(this);var a=o(this).siblings("div").find("input").val();console.log("ssaavvee",o(this).data("url"));var e='<p class="py-2 text-sm font-normal text-gray-900 dark:text-white">'+a+"</p>";o(this).siblings("div").find("input").replaceWith(e),o(this).html('<i class="fa-solid fa-pencil"></i>').addClass("edit-button").removeClass("save-button"),o.ajax({type:"POST",url:o(this).data("url"),data:{content:a},headers:{"X-CSRF-TOKEN":o('meta[name="csrf-token"]').attr("content")},success:function(r){},error:function(r,s,l){console.error(r.responseText)}})});let c;t(document).on("click",".reply-button",function(a){const e=t(this).parent().attr("id"),r=t(this).parent().data("comment_id");if(c=t(this).parent().data("reply_route"),!t(`#replyBox${e}`).length){const s=`
        <div class="flex items-end w-11/12 gap-4 py-2" id="replyBox${e}">
          <input class="rounded-md" type="text" id="reply${e}" placeholder="Write a reply...">
          <button data-comment_id="${e}" data-comment_primary_id="${r}" class="px-3 py-2 text-white bg-blue-500 rounded-md postReply" type="button">Post</button>
        </div>
      `;t(this).siblings(".replies").append(s),setTimeout(()=>t(`#reply${e}`).focus(),0)}}),t(document).on("click",".postReply",function(a){a.preventDefault();const e=t(this).data("comment_id"),r=t(this).data("comment_primary_id");console.log(c),d(e,r)});function d(a,e){const r=o(`#reply${a}`),s=o(`#replyBox${a}`),l=r.val();console.log(c),s.remove(),o.ajax({type:"POST",url:c,data:{content:l,commentId:e},headers:{"X-CSRF-TOKEN":o('meta[name="csrf-token"]').attr("content")},success:function(n){const i=m(l,n.data.update_url);o(`#${a} .replies`).append(i)},error:function(){alert("Error posting reply. Please try again.")}})}function m(a,e){const r=o("#userImg").attr("src"),s=o("#userName").text();return`
        <div class="flex items-start w-11/12 gap-2 ml-auto reply">
            <img class="w-8 h-8 rounded-full" src="${r}" alt="{{ auth()->user()->name }} image">
            <div class="flex flex-col w-full leading-1.5 px-4 py-2 border-gray-200 bg-gray-100 max-w-[320px] rounded-e-xl rounded-es-xl dark:bg-gray-700">
                <div class="flex items-center space-x-2 rtl:space-x-reverse">
                    <span class="text-sm font-semibold text-gray-900 dark:text-white">${s}</span>
                    <span class="text-sm font-normal text-gray-500 dark:text-gray-400">Now</span>
                </div>
                <p class="py-2 text-sm font-normal text-gray-900 dark:text-white">${a}</p>
            </div>
            <button data-url="${e}" class="inline-flex items-center self-center p-2 text-sm font-medium text-center text-gray-900 bg-white rounded-lg hover:bg-gray-100 focus:ring-4 focus:outline-none dark:text-white focus:ring-gray-50 dark:bg-gray-900 dark:hover:bg-gray-800 dark:focus:ring-gray-600 edit-button" type="button">
                <i class="fa-solid fa-pencil"></i>
            </button>
        </div>
    `}});
